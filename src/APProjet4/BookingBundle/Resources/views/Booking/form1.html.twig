{# src/OC/PlatformBundle/Resources/views/Advert/form1.html.twig #}

<form id="myForm">
    <div class="pull-right"
    <span>
        <a href="#" 
           data-toggle="popover" 
           data-content=" - Gratuit pour les - de 4 ans.-------------------------------------------
           - Tarif enfant de 4 à 11 ans. -------------------------------------------
           - Tarif réduit sous certaines conditions 
           (étudiant, employé du musée, d’un service du Ministère de la Culture, militaire…)-------------------------
           - Tarif sénior s'applique dès 60 ans. ------------------------------
           Un justificatif pourra vous être demandé à l'entrée du musée"
           data-placement="left">
            <i alt="info_icon" class="material-icons info" id="fareInfo">&#xe88f;</i>
        </a>
    </span>
    </div>
    <div class="ticket" name="billet">
        
        <h3 id="ticketTitle">Billet n°1{#numéro de billet (correspond au nombre de billets#}</h3>
        
        <div class="ticket-type col-lg-12">
            <div class="row">CHOISISSEZ VOTRE TARIF : 
                    <br><br> 
                <div class="row">
                    <div class="btn-group btn-group-toggle" data-toggle="buttons">
                        <label for="normal" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input " 
                                   type="radio"
                                   autocomplete="off"
                                   value="normal"
                                   name="ticketFare"
                                   id="normal"/>TARIF NORMAL<br><br>
                            <span style="padding-left: 20px" id="normalFull" class="full"  value="16">16€</span>
                            <span style="padding-left: 20px" id="normalHalf"  class="half"value="8">8€</span>
                        </label>
                        <label for="reduct" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input"  
                                   type="radio" 
                                   autocomplete="off"
                                   value="reduct"
                                   name="ticketFare"
                                   id="reduct"/>TARIF REDUIT<br><br>
                            <span style="padding-left: 20px" id="reductFull" class="full"value="8">8€</span>
                            <span style="padding-left: 20px" id="reductHalf" class="half" value="4">4€</span>
                        </label>
                        <label for="child" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input" 
                                   type="radio" 
                                   autocomplete="off"
                                   value="child"
                                   name="ticketFare"
                                   id="child"/>ENFANT<br><br>
                            <span class="full" id="childFull" value="6">6€</span>
                            <span class="half"  id="childHalf" value="3">3€</span>
                        </label>
                        <label for="senior" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input" 
                                   type="radio" 
                                   autocomplete="off"
                                   value="senior"
                                   name="ticketFare"
                                   id="senior"/>SENIOR<br><br>
                            <span class="full" id="seniorFull" value="10">10€</span>
                            <span class="half" id="seniorHalf" value="5">5€</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12">

            <label class="input js-input">
                <input type="text" 
                       class="native js-native champ" 
                       placeholder="Nom du visiteur" 
                       data-validation="length alphanumeric" 
                       data-validation-length="2-15"
                       value=""
                       id="lastname"
                       name="lastname"/>
                <span class="label" data-label="Nom" aria-role="label">Nom du visiteur</span>
                <span class="message" data-label="Merci de renseigner le nom du visiteur" aria-role="label">Nom du visiteur</span>
                {# span id="helpLastname#}
            </label>
            <label class="input js-input">
                <input type="text" 
                       class="native js-native champ" 
                       placeholder="Prénom du visiteur"
                       data-validation="length alphanumeric" 
                       data-validation-length="2-12" 
                       data-validation-error-msg="Merci de renseigner le prénom du visiteur"
                       value=""
                       id="firstname"
                       name="firstname"/>
                <span class="label" data-label="Prénom" aria-role="label">Prénom du visiteur</span>
                <span class="message" data-label="Merci de renseigner le prénom du visiteur" aria-role="label">Prénom du visiteur</span>
            </label>
            <label class="input js-input">
                <input type="date" 
                       class="native champ" 
                       data-validation="length alphanumeric" 
                       data-validation-error-msg="Merci de renseigner la date de naissance du visiteur"
                       value=""
                       id="dateOfBirth"
                       name="dateOfBirth"/>
                <span class="label" data-label="Date de naissance" aria-role="label">Date de naissance</span>
                <span class="message" data-label="Merci de renseigner la date de naissance du visiteur" aria-role="label">Date de naissance</span>
            </label>
            <label for="country" class="input js-input">	
                <input type="select"  class="native champ" data-validation="length alphanumeric"
                       value=""
                       id="countryInput"
                       name="country"
                       disabled/>
                <span class="label" data-label="Pays de résidence" aria-role="label">Pays de résidence</span>
                <span class="message" aria-role="label">Pays de résidence</span>
                <select class="native js-native" name="country" id="country">
                    <option class="form__option" value="">Pays de résidence</option>
                    <option class="form__option" value="AR">Argentina</option>
                    <option class="form__option" value="AU">Australia</option>
                    <option class="form__option" value="AT">Austria</option>
                    <option class="form__option" value="BY">Belarus</option>
                    <option class="form__option" value="BE">Belgium</option>
                    <option class="form__option" value="BA">Bosnia and Herzegovina</option>
                    <option class="form__option" value="BR">Brazil</option>
                    <option class="form__option" value="BG">Bulgaria</option>
                    <option class="form__option" value="CA">Canada</option>
                    <option class="form__option" value="CL">Chile</option>
                    <option class="form__option" value="CN">China</option>
                    <option class="form__option" value="CO">Colombia</option>
                    <option class="form__option" value="CR">Costa Rica</option>
                    <option class="form__option" value="HR">Croatia</option>
                    <option class="form__option" value="CU">Cuba</option>
                    <option class="form__option" value="CY">Cyprus</option>
                    <option class="form__option" value="CZ">Czech Republic</option>
                    <option class="form__option" value="DK">Denmark</option>
                    <option class="form__option" value="DO">Dominican Republic</option>
                    <option class="form__option" value="EG">Egypt</option>
                    <option class="form__option" value="EE">Estonia</option>
                    <option class="form__option" value="FI">Finland</option>
                    <option class="form__option" value="FR">France</option>
                    <option class="form__option" value="GE">Georgia</option>
                    <option class="form__option" value="DE">Germany</option>
                    <option class="form__option" value="GI">Gibraltar</option>
                    <option class="form__option" value="GR">Greece</option>
                    <option class="form__option" value="HK">Hong Kong S.A.R., China</option>
                    <option class="form__option" value="HU">Hungary</option>
                    <option class="form__option" value="IS">Iceland</option>
                    <option class="form__option" value="IN">India</option>
                    <option class="form__option" value="ID">Indonesia</option>
                    <option class="form__option" value="IR">Iran</option>
                    <option class="form__option" value="IQ">Iraq</option>
                    <option class="form__option" value="IE">Ireland</option>
                    <option class="form__option" value="IL">Israel</option>
                    <option class="form__option" value="IT">Italy</option>
                    <option class="form__option" value="JM">Jamaica</option>
                    <option class="form__option" value="JP">Japan</option>
                    <option class="form__option" value="KZ">Kazakhstan</option>
                    <option class="form__option" value="KW">Kuwait</option>
                    <option class="form__option" value="KG">Kyrgyzstan</option>
                    <option class="form__option" value="LA">Laos</option>
                    <option class="form__option" value="LV">Latvia</option>
                    <option class="form__option" value="LB">Lebanon</option>
                    <option class="form__option" value="LT">Lithuania</option>
                    <option class="form__option" value="LU">Luxembourg</option>
                    <option class="form__option" value="MK">Macedonia</option>
                    <option class="form__option" value="MY">Malaysia</option>
                    <option class="form__option" value="MT">Malta</option>
                    <option class="form__option" value="MX">Mexico</option>
                    <option class="form__option" value="MD">Moldova</option>
                    <option class="form__option" value="MC">Monaco</option>
                    <option class="form__option" value="ME">Montenegro</option>
                    <option class="form__option" value="MA">Morocco</option>
                    <option class="form__option" value="NL">Netherlands</option>
                    <option class="form__option" value="NZ">New Zealand</option>
                    <option class="form__option" value="NI">Nicaragua</option>
                    <option class="form__option" value="KP">North Korea</option>
                    <option class="form__option" value="NO">Norway</option>
                    <option class="form__option" value="PK">Pakistan</option>
                    <option class="form__option" value="PS">Palestinian Territory</option>
                    <option class="form__option" value="PE">Peru</option>
                    <option class="form__option" value="PH">Philippines</option>
                    <option class="form__option" value="PL">Poland</option>
                    <option class="form__option" value="PT">Portugal</option>
                    <option class="form__option" value="PR">Puerto Rico</option>
                    <option class="form__option" value="QA">Qatar</option>
                    <option class="form__option" value="RO">Romania</option>
                    <option class="form__option" value="RU">Russia</option>
                    <option class="form__option" value="SA">Saudi Arabia</option>
                    <option class="form__option" value="RS">Serbia</option>
                    <option class="form__option" value="SG">Singapore</option>
                    <option class="form__option" value="SK">Slovakia</option>
                    <option class="form__option" value="SI">Slovenia</option>
                    <option class="form__option" value="ZA">South Africa</option>
                    <option class="form__option" value="KR">South Korea</option>
                    <option class="form__option" value="ES">Spain</option>
                    <option class="form__option" value="LK">Sri Lanka</option>
                    <option class="form__option" value="SE">Sweden</option>
                    <option class="form__option" value="CH">Switzerland</option>
                    <option class="form__option" value="TW">Taiwan</option>
                    <option class="form__option" value="TH">Thailand</option>
                    <option class="form__option" value="TN">Tunisia</option>
                    <option class="form__option" value="TR">Turkey</option>
                    <option class="form__option" value="UA">Ukraine</option>
                    <option class="form__option" value="AE">United Arab Emirates</option>
                    <option class="form__option" value="GB">United Kingdom</option>
                    <option class="form__option" value="US">USA</option>
                    <option class="form__option" value="UZ">Uzbekistan</option>
                    <option class="form__option" value="VN">Vietnam</option>
                </select>
            </label>
        </div>
    </div>

    <div id="AddDeleteTicket">
        <button href="javascript:;"  title="Ajouter un ticket" class="addTicket"
                rel="ticket"style="color:#000; text-decoration: none;">
            Ajouter un ticket
        </button>

        <a href="javascript:;" title="Supprimer un ticket" style="font-size:20px" class="deleteTicket btn btn-danger btn-lg" rel="ticket">
            <span class="glyphicon glyphicon-trash"></span>
        </a>
    </div>


</form>

{% block javascript %}
    <script>/////////Ajout et suppression de ticket////////

        //to do faire en sorte que le premier if soit pour chaque nouveau formulaire
        //to do : On doit récupérer la variable "n" pour l'afficher après "Billet" 


        $(document).ready(function () {
            //On cache l'icone "Supprimer"
            $(".deleteTicket").hide();
            //Au clic sur "Ajouter un ticket"
            $('.addTicket').click(function (e) {
                //To do : Il faut empêcher l'ajout d'un second ticket si le premier n'est pas rempli 
                e.preventDefault();
  //--------> //if (!$(".form-check-input").val() || !$('#lastname').val() || !$('#firstname').val() || !$('#dateOfBirth').val() || !$('#country').val()) {
                //toastr.warning('Merci de renseigner tous les champs.', '', {positionClass: "toast-top-center"});
                 //       return;
                //}
                //Sinon, on ajoute un ticket
                    var form = $(this).closest('form');
                    var ticketList = form.find('.ticket');
                    //Le nombre de ticket déjà présents
                    var n = ticketList.length;
                    //Le premier ticket que l'on va cloner
                    var firstTicket = $(ticketList[0]);
                    //Le dernier ticket de la liste
                    var lastTicket = $(ticketList[n - 1]);
                    //Un ticket cloné
                    var clonedTicket = firstTicket.clone();
                    //J'affiche le nombre de tickets pour vérifier
                    var nbTickets = document.getElementsByClassName("ticket").length;
                    console.log(nbTickets);
           
                    //Pour chaque ticket cloné
                    clonedTicket.find('input', 'h3').each(function () {
                        //On vide la valeur
                        $(this).val('').end();
                        //On change le nom en ajoutant le numéro
                        $(this).attr('name', $(this).attr('name') + n);
                        //on modifie l'id pour ne pas qu'ils soient identiques. 
                        //????
                        //On vide la valeur checked ------- NE FONCTIONNE PAS !!!!!
                        $(this).prop('checked', false);
                        //On modifie le titre en fonction de nbTickets 
                        document.getElementById('ticketTitle').innerHTML = 'Billet n°' + nbTickets; //Ne fonctionne pas : Pas dans le bon sens. Le 1 devient 2...  
                       //$(this).getElementsByTagName('h3', $(this).tagName('h3') + nbTickets);
                        });
                        
                    //On ajoute après les autres tickets
                    clonedTicket.insertAfter(lastTicket).hide().fadeIn('slow');
                    //on ajoute le lien de suppression
                    $(".deleteTicket").fadeIn("fast");
                
                });
                //On peut supprimer le dernier ticket
                $(".deleteTicket").click(function () {
                var ticket = $(".ticket:last");
                ticket.remove();
                toastr.warning('Le dernier formulaire a bien été supprimé.', '', {positionClass: "toast-top-center"});
                });
                //S'il y a 1 seul article, on cache le bouton supprimer
                if ($(".ticket").length < 3) {
                $(".deleteTicket").fadeOut("fast");
                }
        });
    </script>

    <script>
        $(document).ready(function () {
            $('[data-toggle="popover"]').popover();
        });
    </script>
    
{% endblock %}