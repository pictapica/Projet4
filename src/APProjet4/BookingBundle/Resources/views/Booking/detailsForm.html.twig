{# src/OC/PlatformBundle/Resources/views/Advert/form1.html.twig #}

<form id="myForm">
    <div class="pull-right">
    <span>
        <a href="#" data-toggle="popover" data-placement="auto right" type="button" 
           data-container="body"data-html="true" id="fareInfo"
           data-placement="left">
            <i alt="info_icon" class="material-icons info">&#xe88f;</i>
        </a>
        <div id="popover-content-fareInfo" class="hide">
                        <ul class="list-group">
                            <li class="list-group-item">{{ 'selectDate.info.free' | trans}}</li>
                            <li class="list-group-item">{{ 'selectDate.info.child' | trans}}</li>
                            <li class="list-group-item">{{ 'selectDate.info.normal' | trans}}</li>
                            <li class="list-group-item">{{ 'selectDate.info.reduct' | trans}}</li>
                            <li class="list-group-item">{{ 'selectDate.info.senior' | trans}}</li>
                        </ul>
                            <p style="padding: 12px;">{{ 'selectDate.info.warning' | trans}}</p>
        </div>
    </span>
    </div>
    <div class="ticket" name="billet">
        <div class="errorMessage" hidden></span></div>
        <h3 id="ticketTitle">{{'ticketMaj'|trans}} n°1</h3>
        
        <div class="ticket-type col-lg-12">
            <div class="row">{{'detailsForm.choice'|trans}} : 
                    <br><br> 
                <div class="row">
                    <div class="btn-group btn-group-toggle fareLabel" data-toggle="buttons">
                        <label for="normal" class="btn btn-warning form-check-label col-xs-6 col-md-3 active">
                            <input class="form-check-input" 
                                   type="radio"
                                   autocomplete="off"
                                   value="normal"
                                   name="ticketFare"
                                   id="normal"
                                   />{{'detailsForm.fare.full'|trans}}<br><br>
                            <span style="padding-left: 20px" id="normalFull" class="full"  value="16">16€</span>
                            <span style="padding-left: 20px" id="normalHalf"  class="half" value="8">8€</span>
                        </label>
                        <label for="reduct" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input"  
                                   type="radio" 
                                   autocomplete="off"
                                   value="reduct"
                                   name="ticketFare"
                                   id="reduct"/>{{'detailsForm.fare.reduct'|trans}}<br><br>
                            <span style="padding-left: 20px" id="reductFull" class="full"value="8">10€</span>
                            <span style="padding-left: 20px" id="reductHalf" class="half" value="4">5€</span>
                        </label>
                        <label for="child" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input" 
                                   type="radio" 
                                   autocomplete="off"
                                   value="child"
                                   name="ticketFare"
                                   id="child"/>{{'detailsForm.fare.child'|trans}}<br><br>
                            <span class="full" id="childFull" value="6">8€</span>
                            <span class="half"  id="childHalf" value="3">4€</span>
                        </label>
                        <label for="senior" class="btn btn-warning form-check-label col-xs-6 col-md-3">
                            <input class="form-check-input" 
                                   type="radio" 
                                   autocomplete="off"
                                   value="senior"
                                   name="ticketFare"
                                   id="senior"/>{{'detailsForm.fare.senior'|trans}}<br><br>
                            <span class="full" id="seniorFull" value="10">12€</span>
                            <span class="half" id="seniorHalf" value="5">6€</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 clientsDetails">

            <label class="input js-input">
                <input type="text" 
                       class="native js-native champ" 
                       placeholder="{{'detailsForm.contact.lastname'|trans}}" 
                       data-validation="length alphanumeric" 
                       data-validation-length="2-15"
                       value=""
                       id="lastname"
                       name="lastname"/>
                <span class="label" data-label="{{'detailsForm.contact.labelLastname'|trans}}" aria-role="label">{{'detailsForm.contact.lastname'|trans}}</span>
                <span class="message" data-label="Merci de renseigner le nom du visiteur" aria-role="label">{{'detailsForm.contact.lastname'|trans}}</span>
                {# span id="helpLastname#}
            </label>
            <label class="input js-input">
                <input type="text" 
                       class="native js-native champ" 
                       placeholder="{{'detailsForm.contact.firstname'|trans}}"
                       data-validation="length alphanumeric" 
                       data-validation-length="2-12" 
                       data-validation-error-msg="Merci de renseigner le prénom du visiteur"
                       value=""
                       id="firstname"
                       name="firstname"/>
                <span class="label" data-label="{{'detailsForm.contact.labelFirstname'|trans}}" aria-role="label">{{'detailsForm.contact.firstname'|trans}}</span>
                <span class="message" data-label="Merci de renseigner le prénom du visiteur" aria-role="label">{{'detailsForm.contact.firstname'|trans}}</span>
            </label>
            <label class="input js-input">
                <input type="date" 
                       class="native champ" 
                       data-validation="length alphanumeric" 
                       data-validation-error-msg="Merci de renseigner la date de naissance du visiteur"
                       min="1920-01-01"
                       max="{{ "now"|date("Y-m-d") }}"
                       value=""
                       id="dateOfBirth"
                       name="dateOfBirth"/>
                <span class="label" data-label="{{'detailsForm.contact.dateOfBirth'|trans}}" aria-role="label">{{'detailsForm.contact.dateOfBirth'|trans}}</span>
                <span class="message" data-label="Merci de renseigner la date de naissance du visiteur" aria-role="label">{{'detailsForm.contact.dateOfBirth'|trans}}</span>
            </label>
            <label for="country" class="input js-input">	
                <span class="label" data-label="{{'detailsForm.contact.country'|trans}}" aria-role="label">{{'detailsForm.contact.country'|trans}}</span>
                <span class="message" aria-role="label">{{'detailsForm.contact.country'|trans}}</span>
                <select class="native js-native" name="country" id="country">
                    <option class="form__option" value="">{{'detailsForm.contact.country'|trans}}</option>
                    <option class="form__option" value="AR">Argentina</option>
                    <option class="form__option" value="AU">Australia</option>
                    <option class="form__option" value="AT">Austria</option>
                    <option class="form__option" value="BY">Belarus</option>
                    <option class="form__option" value="BE">Belgium</option>
                    <option class="form__option" value="BA">Bosnia and Herzegovina</option>
                    <option class="form__option" value="BR">Brazil</option>
                    <option class="form__option" value="BG">Bulgaria</option>
                    <option class="form__option" value="CA">Canada</option>
                    <option class="form__option" value="CL">Chile</option>
                    <option class="form__option" value="CN">China</option>
                    <option class="form__option" value="CO">Colombia</option>
                    <option class="form__option" value="CR">Costa Rica</option>
                    <option class="form__option" value="HR">Croatia</option>
                    <option class="form__option" value="CU">Cuba</option>
                    <option class="form__option" value="CY">Cyprus</option>
                    <option class="form__option" value="CZ">Czech Republic</option>
                    <option class="form__option" value="DK">Denmark</option>
                    <option class="form__option" value="DO">Dominican Republic</option>
                    <option class="form__option" value="EG">Egypt</option>
                    <option class="form__option" value="EE">Estonia</option>
                    <option class="form__option" value="FI">Finland</option>
                    <option class="form__option" value="FR">France</option>
                    <option class="form__option" value="GE">Georgia</option>
                    <option class="form__option" value="DE">Germany</option>
                    <option class="form__option" value="GI">Gibraltar</option>
                    <option class="form__option" value="GR">Greece</option>
                    <option class="form__option" value="HK">Hong Kong S.A.R., China</option>
                    <option class="form__option" value="HU">Hungary</option>
                    <option class="form__option" value="IS">Iceland</option>
                    <option class="form__option" value="IN">India</option>
                    <option class="form__option" value="ID">Indonesia</option>
                    <option class="form__option" value="IR">Iran</option>
                    <option class="form__option" value="IQ">Iraq</option>
                    <option class="form__option" value="IE">Ireland</option>
                    <option class="form__option" value="IL">Israel</option>
                    <option class="form__option" value="IT">Italy</option>
                    <option class="form__option" value="JM">Jamaica</option>
                    <option class="form__option" value="JP">Japan</option>
                    <option class="form__option" value="KZ">Kazakhstan</option>
                    <option class="form__option" value="KW">Kuwait</option>
                    <option class="form__option" value="KG">Kyrgyzstan</option>
                    <option class="form__option" value="LA">Laos</option>
                    <option class="form__option" value="LV">Latvia</option>
                    <option class="form__option" value="LB">Lebanon</option>
                    <option class="form__option" value="LT">Lithuania</option>
                    <option class="form__option" value="LU">Luxembourg</option>
                    <option class="form__option" value="MK">Macedonia</option>
                    <option class="form__option" value="MY">Malaysia</option>
                    <option class="form__option" value="MT">Malta</option>
                    <option class="form__option" value="MX">Mexico</option>
                    <option class="form__option" value="MD">Moldova</option>
                    <option class="form__option" value="MC">Monaco</option>
                    <option class="form__option" value="ME">Montenegro</option>
                    <option class="form__option" value="MA">Morocco</option>
                    <option class="form__option" value="NL">Netherlands</option>
                    <option class="form__option" value="NZ">New Zealand</option>
                    <option class="form__option" value="NI">Nicaragua</option>
                    <option class="form__option" value="KP">North Korea</option>
                    <option class="form__option" value="NO">Norway</option>
                    <option class="form__option" value="PK">Pakistan</option>
                    <option class="form__option" value="PS">Palestinian Territory</option>
                    <option class="form__option" value="PE">Peru</option>
                    <option class="form__option" value="PH">Philippines</option>
                    <option class="form__option" value="PL">Poland</option>
                    <option class="form__option" value="PT">Portugal</option>
                    <option class="form__option" value="PR">Puerto Rico</option>
                    <option class="form__option" value="QA">Qatar</option>
                    <option class="form__option" value="RO">Romania</option>
                    <option class="form__option" value="RU">Russia</option>
                    <option class="form__option" value="SA">Saudi Arabia</option>
                    <option class="form__option" value="RS">Serbia</option>
                    <option class="form__option" value="SG">Singapore</option>
                    <option class="form__option" value="SK">Slovakia</option>
                    <option class="form__option" value="SI">Slovenia</option>
                    <option class="form__option" value="ZA">South Africa</option>
                    <option class="form__option" value="KR">South Korea</option>
                    <option class="form__option" value="ES">Spain</option>
                    <option class="form__option" value="LK">Sri Lanka</option>
                    <option class="form__option" value="SE">Sweden</option>
                    <option class="form__option" value="CH">Switzerland</option>
                    <option class="form__option" value="TW">Taiwan</option>
                    <option class="form__option" value="TH">Thailand</option>
                    <option class="form__option" value="TN">Tunisia</option>
                    <option class="form__option" value="TR">Turkey</option>
                    <option class="form__option" value="UA">Ukraine</option>
                    <option class="form__option" value="AE">United Arab Emirates</option>
                    <option class="form__option" value="GB">United Kingdom</option>
                    <option class="form__option" value="US">USA</option>
                    <option class="form__option" value="UZ">Uzbekistan</option>
                    <option class="form__option" value="VN">Vietnam</option>
                </select>
            </label>
        </div>
    </div>

    <div id="AddDeleteTicket">
        <button href="javascript:;"  title="{{'detailsForm.addTicket'|trans}}" class="addTicket"
                rel="ticket"style="color:#000; text-decoration: none;">
            {{'detailsForm.addTicket'|trans}}
        </button>

        <a href="javascript:;" title="Supprimer un ticket" style="font-size:20px" class="deleteTicket btn btn-danger btn-lg" rel="ticket">
            <span class="glyphicon glyphicon-trash"></span>
        </a>
    </div>


</form>

{% block javascript %}
    <script>/////////Ajout et suppression de ticket////////

        $(document).ready(function () {
            //On cache l'icone "Supprimer"
            $(".deleteTicket").hide();
            //Au clic sur "Ajouter un ticket"
            $('.addTicket').click(function (e) {
                //To do : Il faut empêcher l'ajout d'un second ticket si le premier n'est pas rempli 
                e.preventDefault();
                
                var form = $('#myForm');
                var ticketList = form.find('.ticket');
                
                //Un ticket cloné
                var clonedTicket = form.find('.ticket:first').clone();
                //On efface les données renseignées
                clonedTicket.find('.clientsDetails input', 'select').val('');
                //On cible le label des type de ticket et on supprime la classe active
                clonedTicket.find('.fareLabel label').removeClass('active');
                //On récupère le 1er label
                clonedTicket.find('.fareLabel label:first').addClass('active');
                //On met à jour le titre
                clonedTicket.find('h3').text('Billet n°'+ ( ticketList.length +1));
                //On ajoute après les autres tickets
                clonedTicket.insertAfter(form.find('.ticket:last')).hide().fadeIn('slow');
                //on ajoute le lien de suppression
                $(".deleteTicket").fadeIn("fast");
            });
            //On peut supprimer le dernier ticket
            $(".deleteTicket").click(function () {
                $(".ticket:last").remove();
                displayWarningToast('{{'detailsForm.deleteForm'|trans}}');
            });
            //S'il y a 1 seul article, on cache le bouton supprimer
            if ($(".ticket").length === 1) {
                $(".deleteTicket").hide();
            }
        });
    </script>
{% endblock %}