{#src/APProjet4/BookingBundle/Resources/views/Booking/selectDate.html.twig #}

{% extends "APProjet4BookingBundle::layout.html.twig" %}


{% block title_section %}
    <section class="banner">
        <div class="container">
            <div class="row">
                <div class="cold-lg-12">
                    <h1>BILLETTERIE</h1>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
{% block APProjet4Booking_body %}
    <nav>
        <ul class="progress-indicator">
            <li class="completed"><span class="bubble"></span><a href="#0">Réservation</a></li>
            <li><span class="bubble"></span><a href="#0">Coordonnées</a></li>
            <li><span class="bubble"></span><a href="#0">Paiement</a></li>
            <li><span class="bubble"></span><a href="#0">Confirmation</a></li>
        </ul>
    </nav>
    <div class="container form">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-xs-12 ">
                <h2>{{event.title}}</h2>
                <p style="text-align:center;">{{event.content}}</p>
                <hr>
            </div>
        </div>
        <div class="row"> 
            <div class="col-lg-offset-1 col-lg-4 col-md-offset-1 col-md-5 col-xs-12 ">
                <div class="form_datetime">
                    <h4>1 - Choisissez une date : <i alt="info_icon" class="material-icons info" id="dateInfo">&#xe88f;</i></h4><br>
                    <input  class=" form_datetime col-lg-offset-1 col-lg-5 col-md-5 col-xs-12" 
                            id="pick_a_date" 
                            type="hidden" 
                            name="pick_a_date" 
                            value=""/>
                </div>
            </div>
            <div id="dateInfoSpace" class="col-lg-2 col-md-2" >
            </div>

            <div id="dateInfoText" class="col-lg-offset-3 col-lg-2 col-md-2">
                <div id="dateInfoCloseCross">
                    <p>Le musée est ouvert tout les jours, de 9h à 18h, 
                        <strong>sauf le mardi, les 1er mai, 1er novembre et 25 décembre</strong>. <br><br>
                    Pour commander pour les dimanches et jours 
                        fériés merci de vous rendre directement au guichet.
                    </p>
                </div>
            </div>


            <div class="  col-lg-4 col-md-4  col-xs-12">
                <h4>2 - Choisissez votre billet <i alt="info_icon" class="material-icons info" id="typeInfo">&#xe88f;</i></h4>
                <button id="daySelect"  class="button">Journée</button>
                <button id="halfDaySelect"  class="button">Demi-journée</button>
            </div>
            <div id="typeInfoText" class="col-lg-2">
                <div id="typeInfoCloseCross">
                    <p>Le billet demi-journée vous permet d'entrer au musée à partir de 14h.</p>
                </div>
            </div>
        </div>

        <hr>
        <div class ="row pull-left">
            <div class="col-lg-12 col-md-12 col-xs-12">
                <br>
                <a href="{{path('approjet4_booking_index')}}"><button class="btn draw-border">Retour</button></a>
            </div>
        </div>
    </div>


    {% block javascript %}
        <script>

            var url_post_date = "{{path('approjet4_booking_pick_a_date')}}";
            var url_contact_details = "{{path('approjet4_booking_contactDetails')}}";

            function submitData(fullDay) {
                var visitDate = $('#pick_a_date').val();

                if (!$('#pick_a_date').val()) {
                    toastr.warning('Vous devez renseigner une date !', '', {positionClass: "toast-top-center"});
                } else {
                    $.post(url_post_date, {
                        visitDate: visitDate,
                        isFullDay: fullDay,
                        id: "{{event.id}}"
                    }, function (response) {
                        if (response.success) {
                            document.location = url_contact_details;
                        } else {
                            toastr.warning('Merci de renseigner une date et de choisir un type de visite.', '', {positionClass: "toast-top-center"});
                        }
                    });
                }
            }
            $(document).ready(function () {
                $('#daySelect').click(function () {
                    submitData(true);
                });

                $('#halfDaySelect').click(function () {
                    submitData(false);
                });
            });

            $.fn.datepicker.dates['fr'] = {
                days: ["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"],
                daysShort: ["Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"],
                daysMin: ["D", "L", "M", "M", "J", "V", "S"],
                months: ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Decembre"],
                monthsShort: ["Jan", "Fev", "Mars", "Avr", "Mai", "Juin", "Juil", "Aout", "Sept", "Oct", "Nov", "Dec"],
                format: "yyyy/mm/dd",
                titleFormat: "MM yyyy",
                weekStart: 1,
                today: "Aujourd'hui"

            };
            $(".form_datetime").datepicker({
                format: "yyyy/mm/dd",
                language: 'fr',
                todayBtn: "linked",
                daysOfWeekDisabled: [0, 2],
                datesDisabled: [
                    ("2018/05/01"),
                    ("2018/11/01"),
                    ("2018/12/25")
                ],
                //beforeShowDay:
                //// on doit récupérer les dates pour lesquelles 
                //on a déjà dépassé 1000 tickets donc pour lesquelles availability = false
                //ex: var daysNotAvailable = [On a pls dates],

                startDate: ("{{event.startDateReservable}}", new Date()),
                endDate: ("{{event.endDateReservable}}")
            });
        </script>
        <script>
            $('#dateInfo').click(function () {
                $('#dateInfoText').show();
                $('#typeInfoText').hide();
            });
            $('#dateInfo').click(function () {
                $('#dateInfoText').show();
            });

            $('#dateInfoCloseCross').click(function () {
                $('#dateInfoText').hide();
                $('#dateInfoSpace').show();
            });

            $('#typeInfo').click(function () {
                $('#typeInfoText').show();
                $('#dateInfoText').hide();

            });
            $('#typeInfo').click(function () {
                $('#typeInfoText').show();
            });

            $('#typeInfoCloseCross').click(function () {
                $('#typeInfoText').hide();
        
            });
        </script>
        {#<script>
            var dateInfo = getElementById('#dateInfo');
            var dateInfoText = getElementById('#dateInfoText');
            var dateInfoCloseCross = getElementById('#dateInfoCloseCross');
            var dateInfoSpace = getElementById('#dateInfoSpace');
            var typeInfo = getElementById('#typeInfo');
            var typeInfoText = getElementById('#typeInfoText');
            var typeInfoCloseCross = getElementById('#typeInfoCloseCross');
            
            dateInfo.addEventListener("click", function (){
                    $(this).style.display = block;
                    };
        </script>#}
        

    {% endblock %}
{% endblock %}

