{#src/APProjet4/BookingBundle/Resources/views/Booking/selectDate.html.twig #}

{% extends "APProjet4BookingBundle::layout.html.twig" %}


{% block title_section %}
    <section class="banner">
        <div class="container">
            <div class="row">
                <div class="cold-lg-12">
                    <h1>{{'banner.title'|trans}}</h1>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
{% block APProjet4Booking_body %}
    <nav>
        <ul class="progress-indicator">
            <li class="completed"><span class="bubble"></span><a href="#0">{{'nav.progress.step1'|trans}}</a></li>
            <li><span class="bubble"></span><a href="#0">{{'nav.progress.step2'|trans}}</a></li>
            <li><span class="bubble"></span><a href="#0">{{'nav.progress.step3'|trans}}</a></li>
            <li><span class="bubble"></span><a href="#0">{{'nav.progress.step4'|trans}}</a></li>
        </ul>
    </nav>
    <div class="container form">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-xs-12 ">
                <h2>{{event.title}}</h2>
                <p style="text-align:center; font-size: 18px;">{{event.content}}</p>
                <hr>
            </div>
        </div>
        <div class="row"> 
            <div class="col-lg-offset-1 col-lg-4 col-md-offset-1 col-md-5 col-xs-12 ">
                <div class="form_datetime">
                    <h4>1 - {{'selectDate.container.step1'|trans}} : 
                        <a href="#" data-toggle="popover" data-placement="auto right"
                           data-content="Le musée est ouvert tout les jours, de 9h à 18h, 
                           sauf le mardi, les 1er mai, 1er novembre et 25 décembre. 
                           Pour commander pour les dimanches et jours 
                           fériés merci de vous rendre directement au guichet.">
                            <i alt="info_icon" class="material-icons info" id="dateInfo">&#xe88f;</i>
                        </a>
                    </h4>
                    <br>
                    <input  class="form_datetime" 
                            id="pick_a_date" 
                            type="hidden" 
                            name="pick_a_date" 
                            value=""/>
                </div>
            </div>
            <div class=" col-lg-offset-2 col-lg-4 col-md-4  col-xs-12">
                <h4>2 - {{'selectDate.container.step2'|trans}} : 
                    <a href="#" data-toggle="popover" data-placement="auto left"
                       data-content="Le billet demi-journée vous permet d'entrer au musée à partir de 14h.">
                        <i alt="info_icon" class="material-icons info" id="typeInfo">&#xe88f;</i>
                    </a>
                </h4>
                <button id="daySelect"  class="button">{{'selectDate.container.fullDay'|trans}}</button>
                <button id="halfDaySelect"  class="button">{{'selectDate.container.halfDay'|trans}}</button>
            </div>
        </div>

        <hr>
        <div class ="row pull-left">
            <div class="col-lg-12 col-md-12 col-xs-12">
                <a href="{{path('approjet4_booking_index')}}"><button class="btn draw-border">{{'button.back'|trans}}</button></a>
            </div>
        </div>
    </div>


    {% block javascript %}
        <script>
            var url_post_date = "{{path('approjet4_booking_pick_a_date')}}";
            var url_contact_details = "{{path('approjet4_booking_showContactDetails')}}";

            function submitData(fullDay) {
                var visitDate = $('#pick_a_date').val();

                if (!$('#pick_a_date').val()) {
                    toastr.warning('Vous devez renseigner une date !', '', {positionClass: "toast-top-center"});
                } else {
                    $.post(url_post_date, {
                        visitDate: visitDate,
                        fullDay: fullDay,
                        id: {{event.id}}
                    }, function (response) {
                        if (response.success) {
                            document.location = url_contact_details;
                        } else {
                            toastr.warning('Merci de renseigner une date et de choisir un type de visite.', '', {positionClass: "toast-top-center"});
                        }
                    });
                }
            }
            $(document).ready(function () {
                $('#daySelect').click(function () {
                    submitData(true);
                });

                $('#halfDaySelect').click(function () {
                    submitData(false);
                });
            });

            $.fn.datepicker.dates['fr'] = {
                days: ["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"],
                daysShort: ["Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"],
                daysMin: ["D", "L", "M", "M", "J", "V", "S"],
                months: ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Decembre"],
                monthsShort: ["Jan", "Fev", "Mars", "Avr", "Mai", "Juin", "Juil", "Aout", "Sept", "Oct", "Nov", "Dec"],
                
                titleFormat: "MM yyyy",
                weekStart: 1,
                today: "Aujourd'hui"

            };
            $.fn.datepicker.dates['en'] = {
                days: ["Sunday", "Monday", "Tuesday", "Wenesday", "Thursday", "Friday", "Saturday"],
                daysShort: ["Sun", "Mon", "Tue", "Wen", "Thu", "Fri", "Sat"],
                daysMin: ["D", "L", "M", "M", "J", "V", "S"],
                months: ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Decembre"],
                monthsShort: ["Jan", "Fev", "Mars", "Avr", "Mai", "Juin", "Juil", "Aout", "Sept", "Oct", "Nov", "Dec"],
                
                titleFormat: "MM yyyy",
                weekStart: 1,
                today: "Aujourd'hui"

            };
            $(".form_datetime").datepicker({
                input:"date",
                format: "yyyy/mm/dd",
                language: 'fr',
                todayBtn: "linked",
                daysOfWeekDisabled: [0, 2],
                datesDisabled: [
                    ("2018-05-01"),
                    ("2018-11-01"),
                    ("2018-12-25")
                ],
                //beforeShowDay:
                //// on doit récupérer les dates pour lesquelles 
                //on a déjà dépassé 1000 tickets donc pour lesquelles availability = false
                //ex: var daysDIsabled = [On a pls dates],

                startDate: ("{{event.startDateReservable}}", new Date()),
                endDate: ("{{event.endDateReservable}}")
            });
        </script>
        <script>//On empêche que les bulles d'infos s'affiche en même temps. 
            $('#dateInfo').click(function () {
                $('#dateInfoText').show();
                $('#typeInfoText').hide();
            });
            $('#dateInfoCloseCross').click(function () {
                $('#dateInfoText').hide();
                $('#dateInfoSpace').show();
            });
            $('#typeInfo').click(function () {
                $('#typeInfoText').show();
                $('#dateInfoText').hide();
            });
            $('#typeInfoCloseCross').click(function () {
                $('#typeInfoText').hide();
            });
        </script>
        <script>
            $(document).ready(function(){
                $('[data-toggle="popover"]').popover(); 
            });
        </script>
    {% endblock %}
{% endblock %}

